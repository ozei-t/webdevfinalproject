<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Song Quiz Results</title>
    <style>
        .timer {
            font-size: 18px;
        }
    </style>
</head>
<body>
<h1>Songs by {{ artist }}</h1>
<p class="timer" id="timer">Time elapsed: 0 seconds</p>
<!-- <ul>
    {% for song, lyric in song_lyrics.items() %}
        <li><strong>{{ song }}</strong>: {{ lyric }}</li>
    {% endfor %}
</ul> -->
<p id="placehold"></p>
<form id="songForm">
    <label for="guessedSong">Enter your guess for the song:</label><br>
    <input type="text" id="guessedSong" name="guessedSong" required><br>
    <button type="submit">Submit</button>
</form>
<script>
    let songs = {};
    {% for song, lyric in song_lyrics.items() %}
        songs["{{ song }}"] = "{{ lyric }}";
    {% endfor %}

    let x = 0;
    let songKeys = Object.keys(songs);
    let placeholdlyric = songs[songKeys[x]];
    document.getElementById("placehold").innerHTML = placeholdlyric;

    // Timer
    let startTime;
    let timerInterval;

    function startTimer() {
        startTime = new Date();
        timerInterval = setInterval(updateTimer, 1000);
    }

    function stopTimer() {
        clearInterval(timerInterval);
    }

    function updateTimer() {
        let currentTime = new Date();
        let elapsedTime = Math.floor((currentTime - startTime) / 1000); // in seconds
        document.getElementById("timer").innerHTML = "Time elapsed: " + elapsedTime + " seconds";
    }

    
    window.onload = startTimer;

    document.getElementById("songForm").addEventListener("submit", function(event) {
        event.preventDefault();
        let guessedSong = document.getElementById("guessedSong").value;
        let correctSong = songKeys[x];
        console.log("guess: ", guessedSong.toLowerCase().trim(), "correct: ", correctSong.toLowerCase().trim())
        console.log("GUESS: ", typeof(guessedSong), "Correct: ", typeof(correctSong))
        if (guessedSong.toLowerCase().trim() === correctSong.toLowerCase().trim()) {
            alert("Correct!");
            stopTimer(); 
            x++;
            if (x < songKeys.length) {
                placeholdlyric = songs[songKeys[x]];
                document.getElementById("placehold").innerHTML = placeholdlyric;
                startTimer(); 
            } else {
                alert("All songs guessed!");
                // You can add further actions here when all songs are guessed
            }
        } else {
            alert("Incorrect, try again!");
        }
        document.getElementById("guessedSong").value = "";
    });
</script>
</body>
</html>
