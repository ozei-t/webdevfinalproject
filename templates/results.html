<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Song Quiz Results</title>
    <style>
       body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex; /* Maintain flexbox for centering */
      flex-direction: column; /* Stack elements vertically */
      justify-content: center; /* Center elements vertically within the viewport */
      align-items: center; /* Center elements horizontally within the viewport */
      height: 100vh;
      background-color: #f2f2f2;
    }

    .timer {
      font-size: 18px;
    }
    </style>
</head>
<body>
<h1>Songs by {{ artist }}</h1>
<p class="timer" id="timer">Time elapsed: 0 seconds</p>
<!-- <ul>
    {% for song, lyric in song_lyrics.items() %}
        <li><strong>{{ song }}</strong>: {{ lyric }}</li>
    {% endfor %}
</ul> -->
<p id="placehold"></p>
<form id="songForm">
    <label for="guessedSong">Enter your guess for the song:</label><br>
    <input type="text" id="guessedSong" name="guessedSong" required><br>
    <button type="submit">Submit</button>
</form>
  <button id="skipButton">Skip Song</button>
<script>
    let songs = {};
    {% for song, lyric in song_lyrics.items() %}
        songs["{{ song }}"] = "{{ lyric }}";
    {% endfor %}

    let x = 0;
    let songKeys = Object.keys(songs);
    let placeholdlyric = songs[songKeys[x]];
    document.getElementById("placehold").innerHTML = placeholdlyric;

    // Timer
    let startTime;
    let timerInterval;

    function startTimer() {
        startTime = new Date();
        timerInterval = setInterval(updateTimer, 100);
    }

    function stopTimer() {
        clearInterval(timerInterval);
    }

    function updateTimer() {
        let currentTime = new Date();
        let elapsedTime = Math.floor((currentTime - startTime) / 100)/10; // in seconds
        document.getElementById("timer").innerHTML = "Time elapsed: " + elapsedTime + " seconds";
    }

    
    window.onload = startTimer;

    document.getElementById("songForm").addEventListener("submit", function(event) {
        event.preventDefault();
        var re = new RegExp("\u2028|\u2029|\u200B");
        let guessedSong = document.getElementById("guessedSong").value.toLowerCase().trim();
        let correctSong = songKeys[x].toLowerCase().trim().replace(re, '');
        console.log("guess")
        for (e of guessedSong.split('')) {
            console.log(e.charCodeAt(0));
        }

        console.log("correct")
        for (e of correctSong.split('')) {
            console.log(e.charCodeAt(0));
        }
        if (guessedSong === correctSong) {
            alert("Correct!");
            stopTimer(); 
            x++;
            if (x < songKeys.length) {
                placeholdlyric = songs[songKeys[x]];
                document.getElementById("placehold").innerHTML = placeholdlyric;
                startTimer(); 
            } else {
                alert("All songs guessed!");
                // You can add further actions here when all songs are guessed
            }
        } else {
            alert("Incorrect, try again!");
        }
        document.getElementById("guessedSong").value = "";
    });
    document.getElementById("skipButton").addEventListener("click", function() {
        if (x < songKeys.length - 1) { // Check if there's a next song
            x++;
            placeholdlyric = songs[songKeys[x]];
            document.getElementById("placehold").innerHTML = placeholdlyric;
            startTimer();
        } else {
            alert("No more songs to skip!");
        }
    });
</script>
</body>
</html>
